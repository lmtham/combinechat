<link href="https://cdn.jsdelivr.net/npm/@n8n/chat/dist/style.css" rel="stylesheet" />
<script type="module">
  // Inject custom CSS for resizing the chatbox
  const style = document.createElement('style');
  style.innerHTML = `
    :root {
      --chat--window--width: 650px; /* Wider window */
      --chat--window--height: 110vh; /* Taller window for more chat history */
      --chat--spacing: 0.5rem;
      --chat--border-radius: 0.20rem;
      --chat--header-height: auto; /* Smaller header */
      --chat--header--padding: var(--chat--spacing); /* Less padding */
      --chat--heading--font-size: 1.4em; /* Smaller font for header */
      --chat--subtitle--font-size: 0.9em; /* Smaller subtitle font */
      --chat--message--font-size: 0.8rem; /* Smaller font for messages */
      --chat--textarea--height: 65px; /* Input box height */
      --chat--toggle--size: 64px;
    }
  `;
  document.head.appendChild(style);

  import { createChat } from 'https://cdn.jsdelivr.net/npm/@n8n/chat/dist/chat.bundle.es.js';

  createChat({
    webhookUrl: 'https://n8ncloud2.onrender.com/webhook/2f82c208-de56-4c9d-8028-c5bfbe4f1428/chat',
    mode: 'fullscreen',  // Set chat window to fullscreen mode
    showWelcomeScreen: false,  // Disable welcome screen
    initialMessages: [],  // No initial messages by default
    i18n: {
      en: {
        getStarted: 'Start New Conversation',  // Change button text
        inputPlaceholder: 'Type your question..', // Initial placeholder
        title: 'Welcome to RichardLaw&Co!ðŸ‘‹',  // Optional, set title text if needed
        subtitle: "Start a chat. We're here to help you 24/7.",
      },
    },
    styleOverrides: {
      '--chat--message--font-size': '0.75rem', // 25% smaller font size
    },
    onLoad: (chatWindow) => {
      // Hide the chat input initially
      const chatInput = chatWindow.querySelector('textarea');
      chatInput.style.display = 'none';  // Hide the input box initially

      // Create and display the 'Start New Conversation' button
      const startButton = document.createElement('button');
      startButton.innerText = 'Start New Conversation';
      startButton.style.width = '100%';
      startButton.style.padding = '10px';
      startButton.style.textAlign = 'center';
      startButton.style.backgroundColor = '#20b69e';
      startButton.style.border = 'none';
      startButton.style.color = '#fff';
      startButton.style.fontSize = '1.2em';
      
      // Insert the start button into the chat window, under title and subtitle
      const chatHistory = chatWindow.querySelector('.n8n-chat-history');
      const header = chatWindow.querySelector('.n8n-chat-header');
      header.appendChild(startButton); // Add the start button below header

      // Add click event to show the input box and change initial message
      startButton.addEventListener('click', () => {
        // Send initial message when button is clicked
        chatWindow.sendMessage('Hi there! ðŸ‘‹ How can I assist you today?');
        startButton.style.display = 'none';  // Hide the start button after click

        // Show the text input
        chatInput.style.display = 'block';  // Show the input box
        chatInput.focus();  // Focus on the input box
      });
    },
  });
</script>
