<script>
  var vapiInstance = null;
  const assistant = "afa7ab83-0e0b-4895-8bcf-1726205ee9dc"; // Substitute with your assistant ID
  const apiKey = "74f983f2-3303-4e57-a098-6c191d3618e1"; // Substitute with your Public key from Vapi Dashboard.
  
  const buttonConfig = {
      position: "bottom-right",
      offset: "40px",
      width: "50px",
      height: "50px",
      idle: {
          color: `rgb(93, 254, 202)`, 
          type: "pill", 
          title: "Have a quick question?", 
          subtitle: "Talk with our AI assistant", 
          icon: `https://unpkg.com/lucide-static@0.321.0/icons/phone.svg`,
      }
  };

  document.addEventListener("DOMContentLoaded", function () {
      // Initialize Vapi widget
      vapiInstance = new VapiWidget(assistant, apiKey, buttonConfig);

      // Load n8n chat widget without default toggle button
      const style = document.createElement('style');
      style.innerHTML = `
          #n8n-chat-toggle { display: none !important; }
      `;
      document.head.appendChild(style);

      import("https://cdn.jsdelivr.net/npm/@n8n/chat/dist/chat.bundle.es.js").then(({ createChat }) => {
          const chatInstance = createChat({
              webhookUrl: 'https://n8ncloud2.onrender.com/webhook/2f82c208-de56-4c9d-8028-c5bfbe4f1428/chat',
              mode: 'window',
              showWelcomeScreen: false,
          });

          // Open n8n chat when Vapi toggle button is clicked
          const vapiButton = document.querySelector('.vapi-widget-button');
          if (vapiButton) {
              vapiButton.addEventListener('click', () => {
                  chatInstance.open();
              });
          }
      });
  });
</script>
